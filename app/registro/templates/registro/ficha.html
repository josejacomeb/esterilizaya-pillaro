<!DOCTYPE html>
{% load static %}
{% load django_bootstrap5 %}

<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Formulario de Consentimiento - {{ registro.nombre }}</title>
    <link rel="icon" type="image/x-icon" href="{% static 'images/happypaws.ico' %}" />
    <link href="{% static 'css/bootstrap-icons.min.css' %}" rel="stylesheet" />
    {% bootstrap_javascript %}
    {% bootstrap_css %}
    <style>
      @page {
        size: A4;
        margin: 10mm;
      }
      
      body {
        font-family: Arial, sans-serif;
        line-height: 1.3;
        font-size: 12pt;
      }
      
      .form-header {
        border: 1px solid #212529;
        background: #fff;
        margin-bottom: 1rem;
        break-inside: avoid;
      }
      
      table {
        width: 100%;
        border-collapse: collapse;
        margin: 1rem 0;
        break-inside: avoid;
      }
      
      th,
      td {
        border: 1px solid #212529;
        padding: 0.5rem;
        text-align: center;
      }
      
      th {
        background-color: #f8f9fa;
        font-weight: bold;
      }
      
      .form-section {
        break-inside: avoid;
        margin-bottom: 1rem;
      }
      
      .form-footer {
        break-inside: avoid;
        margin-top: 2rem;
      }
      
      .signature-box {
        display: flex;
        justify-content: space-between;
        margin-top: 2rem;
        break-inside: avoid;
      }
      
      .signature-section {
        width: 45%;
        text-align: center;
      }
      
      .signature-line {
        border-top: 1px solid #212529;
        margin-top: 2rem;
        padding-top: 0.5rem;
      }
      
      h5,
      h6 {
        margin: 0.5rem 0;
        font-weight: bold;
      }
      
      ol {
        padding-left: 1.2rem;
        margin: 0.5rem 0;
      }
      
      ol li {
        margin-bottom: 0.3rem;
        line-height: 1.2;
      }
      
      @media print {
        .no-print {
          display: none;
        }
      }
    </style>
  </head>

  <body>
    <div class="container-fluid">
      <!-- No-print buttons -->
      {% if not pdf_mode %}
        <div class="row text-center mb-3 no-print">
          <li class="list-group-item d-flex align-items-center px-2 gap-2">
            {% url 'inscripcion:index' registro.inscripcion.campana.id as url_inscripcion %}
            {% bootstrap_button '<i class="bi bi-pencil-square"></i> Registrar otro' button_type='link' href=url_inscripcion button_class='btn btn-primary' %}
            {% url 'registro:generar_pdf' registro.id as url_imprimir %}
            {% bootstrap_button '<i class="bi bi-printer"></i> Imprimir' button_type='link' href=url_imprimir button_class='btn btn-primary' %}
            {% url 'registro:lista' registro.inscripcion.campana.id as url_lista %}
            {% bootstrap_button '<i class="bi bi-card-list"></i> Todos Registros' button_type='link' href=url_lista button_class='btn btn-primary' %}
          </li>
        </div>
      {% endif %}

      <!-- Header with logos -->
      <div>
        <div class="text-center form-header d-flex justify-content-between align-items-center p-2 mb-2">
          <div style="text-align: center; flex: 1;">
            <h4><strong>Nº Ficha</strong></h4>
            <h3>{{ registro.numero_turno }}</h3>
          </div>
          <div>
            <img src="{% static 'images/animalzoo.png' %}" alt="Animal Zoo" style="height: 75px;" />
            <img src="{% static 'images/happypaws.png' %}" alt="Happy Paws" style="height: 75px;" />
          </div>
          <div style="text-align: center; flex: 1;">
            <h4><strong>Peso (Kg)</strong></h4>
            <h3>{{ registro.peso }}</h3>
          </div>
        </div>
      </div>

      <!-- Title Section -->
      <div class="form-section text-center">
        <h5>Jornadas de Esterilización a Bajo Costo</h5>
        <h6>Formulario de Consentimiento para Procedimientos Quirúrgicos</h6>
      </div>

      <!-- Location and Date -->
      <div class="form-section">
        <p>
          <strong>Lugar:</strong> {{ registro.inscripcion.campana.barrio }}, {{ registro.inscripcion.campana.get_parroquia_display }} de Pillaro, Ecuador<br />
          <strong>Fecha:</strong> {{ registro.inscripcion.campana.fecha|date:'l, d F Y' }}
        </p>
      </div>

      <!-- Pet Information -->
      <div class="col-12 py-2">
        <div class="table-responsive">
          <table class="table table-bordered text-center mb-1 border-1px-dark">
            <thead class="table-light">
              <tr>
                <th>Especie</th>
                <th>Género</th>
                <th>Edad</th>
                <th>Raza</th>
                <th>Carnet Vacunación</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>{{ registro.get_especie_display }}</td>
                <td>{{ registro.get_sexo_display }}</td>
                <td>
                  {% include 'registro/edad.html' with edad_anos=registro.edad_anos edad_meses=registro.edad_meses completo=True %}
                </td>
                <td>{{ registro.raza_mascota }}</td>
                <td>{{ registro.get_carnet_display }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <!-- Owner Information -->
      <div class="form-section mb-2">
        <p>
          <i>Nombre Tutor:</i> {{ registro.nombres_tutor }},
          <i>Medio Contacto:</i> {{ registro.numero_telefono_tutor|stringformat:'010d' }},
          <i>CI:</i> {{ registro.cedula_identidad|stringformat:'010d' }}
          <br />
          <i>Domicilio:</i> {{ registro.get_parroquia_tutor_display }} / {{ registro.barrio_tutor }},
          <i>Razón Tenencia:</i> {{ registro.get_razon_tenencia_display }}
          <br />
        </p>
      </div>

      <!-- Terms and Conditions -->
      <div class="form-section">
        <h5>Admito que:</h5>
        <ol style="padding-left: 18px">
          <li>Mi mascota está en perfectas condiciones de salud ya que he sido responsable en asistir con ella a un médico veterinario para sus controles rutinarios</li>
          <li>Comprendo perfectamente en que consiste el procedimiento de esterilización que se le realizará a mi mascota</li>
          <li>Tengo conocimiento sobre los riesgos que puedan existir al momento de la inducción al anestésico o en el proceso de cirugía. Este riesgo puede conllevar a la muerte.</li>
          <li>Doy mi consentimiento informado para que se realice la cirugía descrita anteriormente, y los procedimientos complementarios que sean necesarios y convenientes durante la intervención a juicio de los profesionales que lo llevan a cabo.</li>
          <li>Se tomen fotografías o filmaciones de la cirugía para estudio médico.</li>
          <li>Proveer mis datos personales y de mi mascota con fines únicamente estadísticos y de identificación</li>
          <li>Acepto tener responsabilidad en la recuperación de mi mascota, suministrándole la medicina descrita por el médico tratante y ayudándole con los cuidados postoperatorios indicados.</li>
        </ol>
      </div>

      <!-- Signature Section -->
      <div class="form-footer">
        <p class="text-center">
          <strong>Por todo lo antes señalado, acepto mi responsabilidad firmando este documento</strong>
        </p>
        <div class="signature-box">
          <div class="signature-section">
            <div class="signature-line">
              {{ registro.nombres_tutor }}<br />
              CI: {{ registro.cedula_identidad|stringformat:'010d' }}
            </div>
          </div>
          <div class="signature-section">
            <div class="signature-line">
              Centro Médico Veterinario<br />
              <strong>AnimalZoo</strong>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
