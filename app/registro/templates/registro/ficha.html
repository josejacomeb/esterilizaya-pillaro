<!DOCTYPE html>
{% load static %}
{% load django_bootstrap5 %}

<html lang="es">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta charset="UTF-8" />
    <title>Formulario de Consentimiento</title>
    <link rel="icon" type="image/x-icon" href="{% static 'images/happypaws.ico' %}" />
    {% bootstrap_css %}
    {% bootstrap_javascript %}
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" />
    <style>
      @page {
        size: A4;
        margin: 10mm;
      }
      
      .border-1px-dark th,
      .border-1px-dark td {
        border: 1px solid #212529 !important;
      }
      
      @media print {
        .no-print {
          display: none !important;
        }
      
        body {
          -webkit-print-color-adjust: exact !important;
          print-color-adjust: exact !important;
        }
      
        /* Mantener Bootstrap, solo evitar saltos de página en secciones importantes */
        .form-section,
        .form-header,
        .form-footer {
          page-break-inside: avoid;
        }
      
        .form-header {
          border: 2px solid #212529 !important;
          background: #fff !important;
        }
      
        .form-header .border-dark {
          border-color: #212529 !important;
        }
      }
    </style>
  </head>

  <body>
    <div class="container-fluid px-2 px-md-5 mt-4">
      <div class="row text-center mb-3 no-print justify-content-center gx-2 gy-1">
        {% if not pdf_mode %}
          <div class="col-12 col-md-auto mb-1 mb-md-0">
            <a href="{% url 'inscripcion:index' registro.inscripcion.campana.id %}" class="btn btn-outline-secondary btn-sm w-100 w-md-auto">Registrar otro Tutor</a>
          </div>
          <div class="col-12 col-md-auto mb-1 mb-md-0">
            <a href="{% url 'registro:generar_pdf' registro.id %}" class="btn btn-primary btn-sm w-100 w-md-auto">Imprimir Ficha</a>
          </div>
          <div class="col-12 col-md-auto">
            <a href="{% url 'registro:lista' registro.inscripcion.campana.id %}" class="btn btn-outline-secondary btn-sm w-100 w-md-auto">Ver todos los registros</a>
          </div>
        {% endif %}
      </div>

      <div class="row mb-2 align-items-center border border-dark p-2 form-header gx-2 gy-1">
        <div class="col-12 d-flex justify-content-between align-items-center flex-wrap">
          <div class="text-center" style="min-width: 120px;">
            <h4 class="mb-1"><strong>Nº Ficha</strong></h4>
            <h3>{{ registro.numero_turno }}</h3>
          </div>
          <div class="d-flex justify-content-center align-items-center flex-wrap mx-2" style="flex: 1 1 0;">
            <img src="{% static 'images/animalzoo.png' %}" alt="Animal Zoo" style="height: 70px;" class="mx-2 mb-1 mb-md-0" />
            <img src="{% static 'images/happypaws.png' %}" alt="Happy Paws" style="height: 70px;" class="mx-2 mb-1 mb-md-0" />
          </div>
          <div class="text-center" style="min-width: 120px;">
            <h4 class="mb-1"><strong>Peso (Kg)</strong></h4>
            <h3>{{ registro.peso }}</h3>
          </div>
        </div>
      </div>

      <div class="mb-2">
        <h5 class="text-center fw-bold">Jornadas de Esterilización a Bajo Costo</h5>
        <h6 class="text-center fw-bold">Formulario de Consentimiento para Procedimientos Quirúrgicos</h6>

        <p>
          <strong>Lugar:</strong> {{ registro.inscripcion.campana.barrio }}, {{ registro.inscripcion.campana.get_parroquia_display }} de Pillaro, Ecuador
          <br />
          <strong>Fecha:</strong> {{ registro.inscripcion.campana.fecha|date:'l, d F Y' }}
        </p>
        <h5 class="fw-bold">Datos del Animal de Compañía</h5>
        <p>
          <i>Nombre:</i> {{ registro.nombre }},
          <i>Color Primario:</i> {{ registro.get_color_principal_display }}
          {% if registro.color_secundario %}
            | <i>Secundario:</i> {{ registro.get_color_secundario_display }}
          {% endif %}
          {% if registro.observaciones %}
            <i>Observaciones:</i> {{ registro.observaciones }}
          {% endif %}
        </p>
      </div>

      <div class="col-12 py-2">
        <div class="table-responsive">
          <table class="table table-bordered text-center mb-1 border-1px-dark">
            <thead class="table-light">
              <tr>
                <th>Especie</th>
                <th>Género</th>
                <th>Edad</th>
                <th>Raza</th>
                <th>Carnet Vacunación</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>{{ registro.get_especie_display }}</td>
                <td>{{ registro.get_sexo_display }}</td>
                <td>
                  {% if registro.edad_anos %}
                    {{ registro.edad_anos }} año{% if registro.edad_anos > 1 %}s{% endif %}
                  {% endif %}
                  {% if registro.edad_meses %}
                    {{ registro.edad_meses }} mes{% if registro.edad_meses > 1 %}es{% endif %}
                  {% endif %}
                </td>
                <td>{{ registro.raza_mascota }}</td>
                <td>{{ registro.get_carnet_display }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <h5 class="fw-bold">Datos de Tutor</h5>
      <div class="form-section mb-2">
        <p>
          <i>Nombre Tutor:</i> {{ registro.nombres_tutor }},
          <i>Medio Contacto:</i> {{ registro.numero_telefono_tutor|stringformat:'010d' }},
          <i>CI:</i> {{ registro.cedula_identidad|stringformat:'010d' }}
          <br />
          <i>Domicilio:</i> {{ registro.get_parroquia_tutor_display }} / {{ registro.barrio_tutor }},
          <i>Razón Tenencia:</i> {{ registro.get_razon_tenencia_display }}
          <br />
        </p>
        <h5 class="fw-bold">Admito que:</h5>
        <ol style="padding-left: 18px; margin-bottom: 0;">
          <li style="margin-bottom: 0; line-height: 1.1;">Mi mascota está en perfectas condiciones de salud ya que he sido responsable en asistir con ella a un médico veterinario para sus controles rutinarios</li>
          <li style="margin-bottom: 0; line-height: 1.1;">Comprendo perfectamente en que consiste el procedimiento de esterilización que se le realizará a mi mascota</li>
          <li style="margin-bottom: 0; line-height: 1.1;">Tengo conocimiento sobre los riesgos que puedan existir al momento de la inducción al anestésico o en el proceso de cirugía. Este riesgo puede conllevar a la muerte.</li>
          <li style="margin-bottom: 0; line-height: 1.1;">Doy mi consentimiento informado para que se realice la cirugía descrita anteriormente, y los procedimientos complementarios que sean necesarios y convenientes durante la intervención a juicio de los profesionales que lo llevan a cabo.</li>
          <li style="margin-bottom: 0; line-height: 1.1;">Se tomen fotografías o filmaciones de la cirugía para estudio médico.</li>
          <li style="margin-bottom: 0; line-height: 1.1;">Proveer mis datos personales y de mi mascota con fines únicamente estadísticos y de identificación</li>
          <li style="margin-bottom: 0; line-height: 1.1;">Acepto tener responsabilidad en la recuperación de mi mascota, suministrándole la medicina descrita por el médico tratante y ayudándole con los cuidados postoperatorios indicados.</li>
        </ol>
      </div>

      <div class="form-footer text-center mt-2">
        <p>
          <strong>Por todo lo antes señalado, acepto mi responsabilidad firmando este documento</strong>
        </p>
        <br />
        <div class="row signature-box px-2 px-md-4 gy-2">
          <div class="col-6 col-md-6 mb-2 mb-md-0">
            <p>
              ________________________ <br />
              Nombre: {{ registro.nombres_tutor }} <br />
              CI: {{ registro.cedula_identidad|stringformat:'010d' }}
            </p>
          </div>
          <div class="col-6 col-md-6">
            <p>
              ________________________
              <br />
              Centro Médico Veterinario <strong>AnimalZoo</strong>
            </p>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
