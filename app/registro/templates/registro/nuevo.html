{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% load static %}

{% block title %}
  Ingresar un nuevo registro
{% endblock %}

{% block content %}
  {% if messages %}
    <ul class="messages list-unstyled">
      {% for message in messages %}
        <li class="alert alert-{{ message.tags|default:'info' }}">{{ message }}</li>
      {% endfor %}
    </ul>
  {% endif %}
  <form method="post" enctype="multipart/form-data" class="mb-3">
    {% csrf_token %}
    {% bootstrap_form form %}
    <button type="submit" class="btn btn-success">Ingresar registro</button>
  </form>
  <a href="{{ request.META.HTTP_REFERER }}" class="btn btn-secondary">Volver</a>
  <script src="{% static 'js/jquery.min.js' %}"></script>
  <script src="{% static 'js/canton_parroquia.js' %}"></script>
  <script>
    $(document).ready(function () {
      const url = "{% url 'campana:listar_canton_parroquia' %}"
      actualizarSelectorCantonParroquia('id_canton', 'id_parroquia', url)
    })
  </script>
  <script src="{% static 'js/jquery.min.js' %}"></script>
  <script src="{% static 'js/canton_parroquia.js' %}"></script>
  <script>
    $(document).ready(function () {
      const url = "{% url 'campana:listar_canton_parroquia' %}"
      actualizarSelectorCantonParroquia('id_canton_tutor', 'id_parroquia_tutor', url)
    })
  </script>
  <script type="module">
    import Autocomplete from '/static/js/autocomplete.js'
    new Autocomplete(document.getElementById('id_raza_mascota'), {
      // Use the live-server option to make a new request with each keypress
      liveServer: true,
      // The URL of our Django view
      server: '/registro/razas/',
      // The parameter name for the search query, which our Django view expects
      serverParams: { q: 'typed' },
      // The fields to use for the value and the label from the JSON response
      valueField: 'id',
      labelField: 'title',
      highlightTyped: true
    })
  </script>
{% endblock %}
